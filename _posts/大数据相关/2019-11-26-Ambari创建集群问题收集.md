---
layout: default
author: muyalei
title: Ambari创建集群问题收集
date: 2019-11-26
tags:
    - 大数据
---

 1、通过web页面安装集群，confirm hosts 这里安装ambari-agent失败
 
先登录各节点主机执行 yum remove ambari-agent，后systemctl daemon-reload；如果还是失败，tail -f /var/log/ambari-server/ambari-server.log 查看日志，很有可能是/etc/yum.repo.d目录下多出了 ambari-hdp-1.repo、 ambari-hdp-2.repo这两个文件，删掉，只保留ambari.repo这个文件
 
 2、重装ambari-server，需要先做的动作
 
 （1）yum remove ambari-server
 
 （2）删除mysql中的ambari库，重新建库ambari
 
3、日志位置： /var/log/ambari-server/ 、 /var/run/ambari-server 、 /var/run/ambari-agent
 
4、通过web页面安装集群，上传私钥这里，不要复制，将ambari-server所在服务器`~/.ssh/id_rsa`文件下载后使用上传文件的方式上传，这一页的添加集群包含的服务器这里
    ，需要填写服务器的FQDN，如 `master.ambari.com`，一台服务器一行。
 
如果上传私钥后，后续操作报错，日志还是显示公钥认证报错：`Permission denied (publickey,gssapi-keyex,gssapi-with-mic)`，使用`ssh-keygen -t dsa`的方式替代rsa    的方式生成密钥。

*参考：*[https://blog.csdn.net/wang_zhenwei/article/details/53955871](https://blog.csdn.net/wang_zhenwei/article/details/53955871)
 
5、第一次安装集群失败后，再次安装，可能报错：`[ambari-action-scheduler] ExecutionCommandWrapper:219 - Unable to lookup the cluster by ID; assuming that th    ere is no cluster and therefore no configs for this execution command: Cluster not found, clusterName=clusterID=-1`

换个集群名字，再次安装时的集群名需要与第一次安装时不同。




---
layout: default
author: muyalei
date: 2019-01-17
title: 安装airflow
tags:
   - airflow相关
---


## 报错

- 错误信息：<br/>

  `raise RuntimeError("By default one of Airflow's dependencies installs a GPL "

  RuntimeError: By default one of Airflow's dependencies installs a GPL dependency (unidecode). To avoid this dependency set SLUGIFY_USES_TEXT_UNIDECODE=yes in your environment when you install or upgrade Airflow. To force installing the GPL version set AIRFLOW_GPL_UNIDECODE`  

  解决方法：<br/>
  export SLUGIFY_USES_TEXT_UNIDECODE=yes


- 错误信息：<br/>
  ![https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2019-01-17-airflow%E5%AE%89%E8%A3%85_%E5%9B%BE%E7%89%871.jpg](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2019-01-17-airflow%E5%AE%89%E8%A3%85_%E5%9B%BE%E7%89%871.jpg)

  解决方法：<br/>
  `yum install gcc-c++`
  `yum install gcc libffi-devel python-devel openssl-devel`

  整理自：<br/>
  *[https://blog.csdn.net/fan3652/article/details/81507288](https://blog.csdn.net/fan3652/article/details/81507288)* 

- 错误信息：<br/>
  ![https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2019-01-17-%E5%AE%89%E8%A3%85airflow_%E5%9B%BE%E7%89%872.jpg](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2019-01-17-%E5%AE%89%E8%A3%85airflow_%E5%9B%BE%E7%89%872.jpg)

  解决方法：<br/>
  Debian/Ubuntu: `apt-get install python-dev libsasl2-dev gcc` CentOS/RHEL: `yum install gcc-c++ python-devel.x86_64 cyrus-sasl-devel.x86_64`

- 错误信息：<br/>
  `Complete output from command python setup.py egg_info:

  sh: mysql_config: command not found

  Traceback (most recent call last):

  File "", line 1, in

  File "/tmp/pip-build-_Ky98x/mysqlclient/setup.py", line 17, in

  metadata, options = get_config()

  File "setup_posix.py", line 44, in get_config

  libs = mysql_config("libs_r")

  File "setup_posix.py", line 26, in mysql_config

  raise EnvironmentError("%s not found" % (mysql_config.path,))

  EnvironmentError: mysql_config not found
  `

  解决方法：<br/>
  `yum install mysql-devel`

  *整理自[https://www.2cto.com/database/201806/757725.html](https://www.2cto.com/database/201806/757725.html)*

- 错误信息：<br/>
  pip3 install apache-airflow 后，执行airflow initdb命令提示找不到airflow命令，将airflow加入/usr/bin下即可 `ln -s /usr/python/bin/pip3 /usr/bin/pip3`
  

- 错误信息：<br/>
  ![https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2019-01-17-%E5%AE%89%E8%A3%85airflow_%E5%9B%BE%E7%89%873.jpg](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2019-01-17-%E5%AE%89%E8%A3%85airflow_%E5%9B%BE%E7%89%873.jpg)
  
  或是其他跟这个类似的错误，都可以用下面的方法解决。  

  解决方法：<br/>
  `pip3 install apache-airflow[hive]`


- 错误信息：<br/>
  Global variable explicit_defaults_for_timestamp needs to be on (1) for mysql <br/>

  解决方法：<br/>
  在/etc/my.cnf文件中增加 explicit_defaults_for_timestamp=1（必须将这句放在[mariadb]下），systemctl restart mariadb重启mariadb<br/>
  如果增加这一句后mariadb重启失败，可能是mariadb版本太低，更新mariadb版本到10.x，具体参考[https://github.com/muyalei/muyalei.github.io/blob/gh-pages/_posts/mysql%E7%9B%B8%E5%85%B3/2019-01-21-mariadb5.x%E5%8D%87%E7%BA%A7%E5%88%B010.x.md](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/_posts/mysql%E7%9B%B8%E5%85%B3/2019-01-21-mariadb5.x%E5%8D%87%E7%BA%A7%E5%88%B010.x.md)


- 错误信息：<br/>
  类似于 `..._mysql_exceptions.OperationalError 1292, "Incorrect datetime value:....` 这种错误<br/>

  解决方法：<br/>
  登入mysql，执行`set global sql_mode='';`，有关sql_mode变量的更多详细信息参考[]()。

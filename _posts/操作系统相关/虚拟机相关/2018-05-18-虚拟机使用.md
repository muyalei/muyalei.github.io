---
layout:     post
title:      虚拟机使用
subtitle:   虚拟机
date:       2018-05-18
author:     muyalei
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - 虚拟机
---

## centos7初始化设置

### 1、网卡设置

/etc/sysconfig/network-scripts/ifcfg-eno16777736中设置网卡eno16777736，修改参数为BOOTPROTO=dhcp、ONBOOT=yes，systemctl restart network，
正常情况下，现在与本机可以相互ping通并且可以连接网络。

如果不能ping通本机且不能连接网络，可尝试 编辑-虚拟网络编辑器 中删除vmnet1、vmnet8后重新添加vmnet1和vmnet8（注意：重新添加的vmnet为仅主机模式，vmnet8为
nat模式！）


### 2、安装ifconfig命令

ifconfig命令包含在`net-tools.x86_64`模块中，执行命令`yum install net-tools.x86_64`


### 3、安装vmware-tools.pl

- 准备：
```
yum install gcc  kernel-headers kernel-devel   ///因为编译需要，要装这几个包
```
- 安装：

首先需要点击vmwaere下面提示的安装VMware Tools按钮，如果不小心将这里的提示信息点掉了，可以点击vmware操作台的 虚拟机>安装VMware Tools 按钮。

```
挂载光驱：
mkdir /mnt/cdrom       ///创建挂载目录
mount /dev/cdrom /mnt/cdrom    ///将光驱挂载到/mnt/cdrom目录（卸载光驱命令是：）
cd /mut/cdrom 
里面有两个文件，.rpm文件是给Red Hat准备的，只需要.tar.gz的那个
cp VMwareTools-XXXX.tar.gz /usr/local     ///复制VMware-tools到/usr/local目录 ，其中XXX是版本号。
cd /usr/local     ///切换到local目录
tar -vzxf VMware Tools-XXX.tar.gz     ///解压，区分大小写，也可以先输入前几个字母按Tab键系统补充后面的。

环境好了，下面开始安装VMware-tools
cd vmware-tools-distrib  ///进入解压出来的目录
./vmware-install.pl    ///运行vmware-install.pl文件开始安装。
会提示若干次yes or no 直接一路回车就行，直到最后出现“Enjoy——the VMware team”的字样，VMwareTools安装完成。

卸载光驱：
umount -v /dev/cdrom #通过设备名称卸载
umount -v /mnt/cdrom #通过挂载点卸载
```
- 卸载：
```
到刚才解压的目录/usr/local/vmware-tools-distrib/bin 目录或者 /usr/bin
cd /usr/local/vmware-tools-distrib/bin
./vmware-uninstall-tools.pl    ///运行卸载程序
rm -rf /etc/vmware-caf     ///递归强制 删除残留目录
rm -rf /etc/vmware-tools   ///递归强制 删除残留目录
rm -rvf /usr/lib/vmware-tools     ///递归强制 删除残留目录
```

### 4、设置虚拟机网卡信息、配置宿主机vmnet8

- 点击vmware操作台的 编辑>虚拟网络编辑器 ，如下图所示，查看默认网关、子网信息

![https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2018-05-18-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8_%E5%9B%BE%E7%89%87_1.jpg](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2018-05-18-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8_%E5%9B%BE%E7%89%87_1.jpg)

![https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2018-05-18-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8_%E5%9B%BE%E7%89%87_2.jpg](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2018-05-18-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8_%E5%9B%BE%E7%89%87_2.jpg)

- 查看宿主机的本地网络适配器，查看是否已经成功安装虚拟网卡vmnet8 

（1）打开宿主机本地网络适配器，查看是否已经成功安装虚拟网卡vmnet8，如果在本地网络适配器中找不到vmnet8，按照后面的解决办法进行排错。

（2）登录虚拟机，配置本机网卡信息，参考：[https://github.com/muyalei/muyalei.github.io/blob/gh-pages/_posts/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/linux%E7%9B%B8%E5%85%B3/2015-07-11-centos7%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP%E5%9C%B0%E5%9D%80.md](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/_posts/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3/linux%E7%9B%B8%E5%85%B3/2015-07-11-centos7%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP%E5%9C%B0%E5%9D%80.md)
    
  注：网关、子网信息，通过上面的获知。

（3）设置宿主机本地网络适配器中的vmnet8，下图是我的配置：

![https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2018-05-18-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8_%E5%9B%BE%E7%89%87_3.png](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2018-05-18-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8_%E5%9B%BE%E7%89%87_3.png)


## 各种意外情况

- 1、win10系统，安装完VMware后，在本地的网络适配器中找不到相关的虚拟网卡VMnet

解决方式参考：[https://blog.csdn.net/liouxiaozhou/article/details/78482242](https://blog.csdn.net/liouxiaozhou/article/details/78482242)

其他解决方式还有：[https://blog.csdn.net/qq_36769100/article/details/78802756](https://blog.csdn.net/qq_36769100/article/details/78802756)，我这里用上面的方式成功解决问题。

防止丢失，解决过程简要记录如下：

第一步：安装CCleaner工具。注意，安装成功后，会让购买激活，直接点取消，就跳到正常使用页面了（我是在华军下载的，是可以这样用的）。

第二步：按照如下图操作：

![https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2018-05-18-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8_%E5%9B%BE%E7%89%87_4.png](https://github.com/muyalei/muyalei.github.io/blob/gh-pages/img/2018-05-18-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BD%BF%E7%94%A8_%E5%9B%BE%E7%89%87_4.png)

第三步：点击 编辑>虚拟网络编辑器>还原默认设置 ， 重新安装虚拟网卡

- 2、安装vmware-tools.pl时报错：`bash: ./vmware-install.pl: /user/bin/perl: 坏的解释器:没有那个文件或目录`

整理自：[https://blog.csdn.net/fanaticism1/article/details/8096494](https://blog.csdn.net/fanaticism1/article/details/8096494)

我这里是直接执行命令 `yum install perl gcc kernel-devel` ，问题解决


- 3、


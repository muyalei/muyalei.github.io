---
layout: default
author: muyalei
title: 向windows操作系统输入按键信号
date: 2019-09-04
tags:
    - 游戏辅助脚本相关
---


***整理自[https://blog.csdn.net/daxialeesuper/article/details/79470487](https://blog.csdn.net/daxialeesuper/article/details/79470487)***


### 一、安装pywin32
使用win32api库进行键盘操作（注意：此方法被操作界面必须在顶层），首先，需要安装win32api的python库，使用命令：
```
pip install pywin32
```

### 二、实例代码
```
import win32api
import win32con
import random,time,datetime



def jump(vk_code):
    vk_code = int(vk_code)
    jump_num = random.randint(0,5) #跳跃次数
    print('角色将跳跃%s次' % jump_num)
    for i in range(jump_num):
        win32api.keybd_event(vk_code,0,0,0)
        win32api.keybd_event(vk_code,0,win32con.KEYEVENTF_KEYUP,0)
        print('第%s次跳跃...' % i)
        if i<jump_num-1:
            time_quantum = random.uniform(0.5,2)
            print('%s秒后进行下一次跳跃' % time_quantum)
            time.sleep(time_quantum)


def go_ahead(vk_code):
    vk_code = int(vk_code)
    time_quantum = random.uniform(0,3) #向前走的时间
    print('角色将前进%s秒...' % time_quantum)
    win32api.keybd_event(vk_code,0,0,0) #按键按下
    time.sleep(time_quantum)
    win32api.keybd_event(vk_code,0,win32con.KEYEVENTF_KEYUP,0) #按键松开
    print('角色前进动作完成！')


def retreat(vk_code):
    vk_code = int(vk_code)
    time_quantum = random.uniform(0,3) #向后退的时间
    print('角色将后退%s秒...' % time_quantum)
    win32api.keybd_event(vk_code,0,0,0)
    time.sleep(time_quantum) #向后退的时间
    win32api.keybd_event(vk_code,0,win32con.KEYEVENTF_KEYUP,0)
    print('角色后退动作完成！')




if __name__=='__main__':
    while True:
        go_ahead(38) #前进
        time.sleep(random.uniform(0.5,2))
        retreat(40) #后退
        time.sleep(random.uniform(0.5,2))
        jump(32) #跳跃
        time_quantum = random.uniform(60,300) #间隔时间，1~5分钟的间隔时间
        print('【%s秒后进行下一轮动作，现在时间：%s】' % (time_quantum,str(datetime.datetime.now())))
        time.sleep(time_quantum)

```

### 三、键盘各键对应的编码值
```
Key                  Code
backspace            8
tab                  9
enter                13
shift                16
ctrl                 17
alt                  18
pause/break          19
caps lock            20
escape               27
page up              33
page down            34
end                  35
home                 36
left arrow           37
up arrow             38
right arrow          39
down arrow           40
insert               45
delete               46
0                    48
1                    49
2                    50
3                    51
4                    52
5                    53
6                    54
7                    55
8                    56
9                    57
a                    65
b                    66
c                    67
d                    68
e                    69
f                    70
g                    71
h                    72
i                    73
j                    74
k                    75
l                    76
m                    77
n                    78
o                    79
p                    80
q                    81
r                    82
s                    83
t                    84
u                    85
v                    86
w                    87
x                    88
y                    89
z                    90
left window key      91
right window key     92
select key           93
numpad 0             96
numpad 1             97
numpad 2             98
numpad 3             99
numpad 4             100
numpad 5             101
numpad 6             102
numpad 7             103
numpad 8             104
numpad 9             105
multiply             106
add                  107
subtract             109
decimal point        110
divide               111
f1                   112
f2                   113
f3                   114
f4                   115
f5                   116
f6                   117
f7                   118
f8                   119
f9                   120
f10                  121
f11                  122
f12                  123
num lock             144
scroll lock          145
semi-colon           186
equal sign           187
comma                188
dash                 189
period               190
forward slash        191
grave accent         192
open bracket         219
back slash           220
close braket         221
single quote         222
```
#### 补充：
```
ESC键VK_ESCAPE (27) 
回车键：VK_RETURN (13) 
TAB键：VK_TAB (9) 
Caps Lock键：VK_CAPITAL (20) 
Shift键：VK_SHIFT (16) 
Ctrl键：VK_CONTROL (17) 
Alt键：VK_MENU (18) 
空格键：VK_SPACE (32) 
退格键：VK_BACK (8) 
左徽标键：VK_LWIN (91) 
右徽标键：VK_RWIN (92) 
鼠标右键快捷键：VK_APPS (93) 
Insert键：VK_INSERT (45) 
Home键：VK_HOME (36) 
Page Up：VK_PRIOR (33) 
PageDown：VK_NEXT (34) 
End键：VK_END (35) 
Delete键：VK_DELETE (46) 
方向键(←)：VK_LEFT (37) 
方向键(↑)：VK_UP (38) 
方向键(→)：VK_RIGHT (39) 
方向键(↓)：VK_DOWN (40) 
F1键：VK_F1 (112) 
F2键：VK_F2 (113) 
F3键：VK_F3 (114) 
F4键：VK_F4 (115) 
F5键：VK_F5 (116) 
F6键：VK_F6 (117) 
F7键：VK_F7 (118) 
F8键：VK_F8 (119) 
F9键：VK_F9 (120) 
F10键：VK_F10 (121) 
F11键：VK_F11 (122) 
F12键：VK_F12 (123) 
Num Lock键：VK_NUMLOCK (144) 
小键盘0：VK_NUMPAD0 (96) 
小键盘1：VK_NUMPAD1 (97) 
小键盘2：VK_NUMPAD2 (98) 
小键盘3：VK_NUMPAD3 (99) 
小键盘4：VK_NUMPAD4 (100) 
小键盘5：VK_NUMPAD5 (101) 
小键盘6：VK_NUMPAD6 (102) 
小键盘7：VK_NUMPAD7 (103) 
小键盘8：VK_NUMPAD8 (104) 
小键盘9：VK_NUMPAD9 (105) 
小键盘。：VK_DECIMAL (110) 
小键盘*：VK_MULTIPLY (106) 
小键盘+：VK_ADD (107) 
小键盘-：VK_SUBTRACT (109) 
小键盘/：VK_DIVIDE (111) 
Pause Break键：VK_PAUSE (19) 
Scroll Lock键：VK_SCROLL (145)
```










---
layout: default
author: muyalei
title: 向windows操作系统输入按键信号
date: 2019-09-04
tags:
    - 游戏脚本相关
---


***整理自[https://blog.csdn.net/daxialeesuper/article/details/79470487](https://blog.csdn.net/daxialeesuper/article/details/79470487)***


### 一、安装pywin32
使用win32api库进行键盘操作（注意：此方法被操作界面必须在顶层），首先，需要安装win32api的python库，使用命令：
```
pip install pywin32
```

### 二、实例代码
```
import win32api
import win32con
import random,time,datetime



def jump(vk_code):
    vk_code = int(vk_code)
    jump_num = random.randint(0,5) #跳跃次数
    print('角色将跳跃%s次' % jump_num)
    for i in range(jump_num):
        win32api.keybd_event(vk_code,0,0,0)
        win32api.keybd_event(vk_code,0,win32con.KEYEVENTF_KEYUP,0)
        print('第%s次跳跃...' % i)
        if i<jump_num-1:
            time_quantum = random.uniform(0.5,2)
            print('%s秒后进行下一次跳跃' % time_quantum)
            time.sleep(time_quantum)


def go_ahead(vk_code):
    vk_code = int(vk_code)
    time_quantum = random.uniform(0,3) #向前走的时间
    print('角色将前进%s秒...' % time_quantum)
    win32api.keybd_event(vk_code,0,0,0) #按键按下
    time.sleep(time_quantum)
    win32api.keybd_event(vk_code,0,win32con.KEYEVENTF_KEYUP,0) #按键松开
    print('角色前进动作完成！')


def retreat(vk_code):
    vk_code = int(vk_code)
    time_quantum = random.uniform(0,3) #向后退的时间
    print('角色将后退%s秒...' % time_quantum)
    win32api.keybd_event(vk_code,0,0,0)
    time.sleep(time_quantum) #向后退的时间
    win32api.keybd_event(vk_code,0,win32con.KEYEVENTF_KEYUP,0)
    print('角色后退动作完成！')




if __name__=='__main__':
    while True:
        go_ahead(38) #前进
        time.sleep(random.uniform(0.5,2))
        retreat(40) #后退
        time.sleep(random.uniform(0.5,2))
        jump(32) #跳跃
        time_quantum = random.uniform(60,300) #间隔时间，1~5分钟的间隔时间
        print('【%s秒后进行下一轮动作，现在时间：%s】' % (time_quantum,str(datetime.datetime.now())))
        time.sleep(time_quantum)

```

###三、键盘各键对应的编码值
```

```












